<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="クラシックなテトリスゲーム、無料で遊べるクラシックなブラウザ版テトリス。スマホ・PC対応、AI観戦モード搭載。インストール不要ですぐ遊べる、ホーム画面に追加可能なPWA対応">
    <meta name="robots" content="index, follow">
    <!-- OGP -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="TETRIS-LIKE | 無料ブラウザ版テトリス風ゲーム">
    <meta property="og:description" content="スマホ・PC対応、AI観戦モード搭載。インストール不要ですぐ遊べる落ちものパズル">
    <meta property="og:image" content="https://tetris-like.pages.dev/ogp.png">
    <meta property="og:url" content="https://tetris-like.pages.dev/">
    <meta property="og:site_name" content="TETRIS-LIKE">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TETRIS-LIKE | 無料ブラウザ版テトリス風ゲーム">
    <meta name="twitter:description" content="スマホ・PC対応、AI観戦モード搭載。インストール不要ですぐ遊べる">
    <meta name="twitter:image" content="https://tetris-like.pages.dev/ogp.png">
    <link rel="icon" href="/icon-192.png">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "0b45464586344910a274a959d7a31fde"}'></script><!-- End Cloudflare Web Analytics -->
    <title>TETRIS-LIKE | 無料で遊べるブラウザ版テトリス風ゲーム</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 星座風背景 -->
    <div class="stars-background" id="starsBackground"></div>
    
    <section style="display:none;">
      <h2>ホーム画面に追加できるテトリス風ゲーム</h2>
      <p>
        このテトリス風ゲームはPWA対応のブラウザゲームです。
        スマートフォンでは「ホーム画面に追加」することで、
        アプリのようにワンタップで起動できます。
        インストール不要で、オフラインでも遊べる設計になっています。
      </p>
    </section>
    
    <!-- ホーム画面 -->
    <div id="homeScreen" class="home-screen">
        <div class="home-title-container">
            <h1 class="home-title">TETRIS-LIKE</h1>
            <button class="info-button" onclick="toggleInfoModal()">ⓘ</button>
        </div>

        
        <!-- AI観戦モードトグル -->
        <div class="ai-toggle-container">
            <label class="ai-toggle-label">
                <input type="checkbox" id="aiModeToggle" onchange="toggleAIMode()">
                <span class="ai-toggle-slider"></span>
            </label>
            <span class="ai-toggle-text">🤖 AI観戦モード</span>
            <span class="ai-toggle-desc" id="aiModeDesc">OFF - 自分でプレイ</span>
        </div>
        
        <div class="mode-selection">
            <div class="mode-button" onclick="startGame('normal')">
                <h2>ノーマル</h2>
                <p>エンドレスモード</p>
                <p>スコアアタック</p>
                <div class="best-time" id="normalBest">最高: - 点</div>
            </div>
            
            <div class="mode-button" onclick="startGame('sprint1m')">
                <h2>1分間スプリント</h2>
                <p>60秒チャレンジ</p>
                <p>ライン数を競う</p>
                <div class="best-time" id="sprint1mBest">最高: - ライン</div>
            </div>
            
            <div class="mode-button" onclick="startGame('time10')">
                <h2>10ライン</h2>
                <p>タイムアタック</p>
                <p>10ライン消去</p>
                <div class="best-time" id="time10Best">記録: --:--.---</div>
            </div>
            
            <div class="mode-button" onclick="startGame('time20')">
                <h2>20ライン</h2>
                <p>タイムアタック</p>
                <p>20ライン消去</p>
                <div class="best-time" id="time20Best">記録: --:--.---</div>
            </div>
            
            <div class="mode-button" onclick="startGame('time40')">
                <h2>40ライン</h2>
                <p>タイムアタック</p>
                <p>40ライン消去</p>
                <div class="best-time" id="time40Best">記録: --:--.---</div>
            </div>
            
            <div class="mode-button" onclick="startGame('time100')">
                <h2>100ライン</h2>
                <p>タイムアタック</p>
                <p>100ライン消去</p>
                <div class="best-time" id="time100Best">記録: --:--.---</div>
            </div>
            
            <div class="mode-button practice-mode" onclick="startGame('practice')">
                <h2>📝 練習モード</h2>
                <p>落下なし / Z: Undo</p>
                <div class="best-time">配置の練習に</div>
            </div>
            
            <div class="mode-button battle-mode" onclick="showBattleDialog()">
                <h2>⚔️ AI対戦</h2>
                <p>おじゃまライン送り合い</p>
                <div class="best-time">難易度選択あり</div>
            </div>
        </div>
        
        <!-- AI対戦難易度選択ダイアログ -->
        <div id="battleDialog" class="battle-dialog hidden">
            <div class="battle-dialog-content">
                <h3>⚔️ AI対戦 - 難易度選択</h3>
                <p>2ライン以上消すとおじゃまラインを送れる！</p>
                <div class="battle-dialog-buttons">
                    <button class="battle-btn easy" onclick="startBattle('easy')">🟢 Easy</button>
                    <button class="battle-btn normal" onclick="startBattle('normal')">🟡 Normal</button>
                    <button class="battle-btn hard" onclick="startBattle('hard')">🟠 Hard</button>
                    <button class="battle-btn hardest" onclick="startBattle('hardest')">🔴 Hardest</button>
                    <button class="battle-btn insane" onclick="startBattle('insane')">💀 Insane</button>
                </div>
                <button class="battle-dialog-cancel" onclick="hideBattleDialog()">キャンセル</button>
            </div>
        </div>

        <div class="rankings">
            <h3>🏆 ランキング</h3>
            <div class="ranking-tabs">
                <button class="ranking-tab active" onclick="showRanking('normal', event)">ノーマル</button>
                <button class="ranking-tab" onclick="showRanking('sprint1m', event)">1分間</button>
                <button class="ranking-tab" onclick="showRanking('time10', event)">10ライン</button>
                <button class="ranking-tab" onclick="showRanking('time20', event)">20ライン</button>
                <button class="ranking-tab" onclick="showRanking('time40', event)">40ライン</button>
                <button class="ranking-tab" onclick="showRanking('time100', event)">100ライン</button>
            </div>
            <div class="ranking-subtabs">
                <button class="ranking-subtab active" onclick="toggleRankingType('human', event)">👤 人間</button>
                <button class="ranking-subtab" onclick="toggleRankingType('ai', event)">🤖 AI</button>
            </div>
            <div class="ranking-list" id="rankingList"></div>
        </div>
    </div>

    <!-- Infoモーダル -->
    <div id="infoModal" class="info-modal hidden">
        <div class="info-modal-content">
            <button class="info-modal-close" onclick="toggleInfoModal()">✕</button>
            <h2 class="info-modal-title">📖 Information</h2>

            <div class="info-section">
                <h3>🎮 ゲームモード</h3>
                <ul>
                    <li><strong>ノーマル</strong>: エンドレスモード。ゲームオーバーまでスコアを稼ごう</li>
                    <li><strong>1分間スプリント</strong>: 60秒間でできるだけ多くのラインを消そう</li>
                    <li><strong>タイムアタック</strong>: 目標ライン数をどれだけ早く消せるか競おう（10/20/40/100ライン）</li>
                </ul>
            </div>

            <div class="info-section">
                <h3>📝 練習モード</h3>
                <p>
                    ミノが自動で落下しない練習専用モード。<br>
                    じっくり考えて配置の練習ができます。<br>
                    <strong>Z キー</strong>または<strong>取り消しボタン</strong>で直前の操作を戻せます。
                </p>
            </div>

            <div class="info-section">
                <h3>⚔️ AI対戦モード</h3>
                <p>
                    AIと1対1で対戦！<br>
                    2ライン以上同時に消すと、相手におじゃまラインを送れます。<br>
                    難易度は5段階（Easy / Normal / Hard / Hardest / Insane）。<br>
                    スマホでは相手の状況が影で表示されます。
                </p>
                <p style="margin-top: 8px; color: #888; font-size: 13px;">
                    ※ AI観戦モードをONにすると、AI同士の対戦を観戦できます
                </p>
            </div>

            <div class="info-section">
                <h3>🕹️ 操作方法</h3>
                <div class="info-controls-grid">
                    <div class="info-controls-col">
                        <h4>💻 PC（キーボード）</h4>
                        <ul>
                            <li>← → : 左右移動</li>
                            <li>↑ : 回転</li>
                            <li>↓ : 高速落下</li>
                            <li>Space : 一気に落下</li>
                            <li>P : 一時停止</li>
                        </ul>
                    </div>
                    <div class="info-controls-col">
                        <h4>📱 スマホ（スワイプ）</h4>
                        <ul>
                            <li>タップ : 回転</li>
                            <li>左右スワイプ : 移動</li>
                            <li>上スワイプ : 一気に落下</li>
                            <li>下スワイプ : 高速落下</li>
                        </ul>
                    </div>
                </div>
                <p style="margin-top: 10px; color: #888; font-size: 13px;">
                    ※ スマホではボタン操作モードも選択できます
                </p>
            </div>

            <div class="info-section">
                <h3>🤖 AI観戦モード</h3>
                <p>
                    AIが自動でテトリスをプレイします。<br>
                    どんな戦略で積み上げるか観察してみよう！<br>
                    AI専用のランキングも記録されます。
                </p>
            </div>

            <div class="info-section">
                <h3>📱 PWA（ホーム画面に追加）</h3>
                <p>
                    このゲームはPWA対応です。<br>
                    スマホのブラウザメニューから「ホーム画面に追加」すると、<br>
                    アプリのようにワンタップで起動できます。<br>
                    インストール不要で、オフラインでも遊べます。
                </p>
            </div>

            <hr class="info-divider">

            <div class="info-contact">
                <p>お問い合わせ・フィードバック</p>
                <p style="margin-top: 5px; color: #666;">@NaK0528</p>
            </div>
        </div>
    </div>

    <!-- ゲーム画面 -->
    <div class="game-container hidden" id="gameScreen">
        <h1>TETRIS-LIKE</h1>
        
        <div class="mode-info" id="modeInfo"></div>
        <div class="time-display" id="timeDisplay"></div>
        <div class="action-display" id="actionDisplay"></div>

        <div class="game-area">
            <canvas id="gameCanvas"></canvas>

            <div class="side-panel">
                <div class="panel-section">
                    <h3>NEXT</h3>
                    <canvas id="nextCanvas" width="120" height="120"></canvas>
                </div>

                <div class="panel-section score-display">
                    <div class="score-label">スコア</div>
                    <div class="score-value" id="scoreDisplay">0</div>
                </div>

                <div class="panel-section score-display">
                    <div class="score-label">レベル</div>
                    <div class="score-value level-value" id="levelDisplay">1</div>
                </div>

                <div class="panel-section score-display">
                    <div class="score-label">ライン</div>
                    <div class="score-value level-value" id="linesDisplay">0</div>
                </div>

                <div class="panel-section" id="controlTogglePanel">
                    <h3>操作方法</h3>
                    <div class="toggle-container">
                        <label class="toggle-label">
                            <input type="checkbox" id="controlToggle" onchange="toggleControlMode()">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-text">ボタン</span>
                    </div>
                    <div class="swipe-instructions" id="swipeInstructions">
                        <div class="swipe-title">スワイプ操作</div>
                        <div>タップ: 回転</div>
                        <div>← →: 移動</div>
                        <div>↑: 一気に落下</div>
                        <div>↓: 高速落下</div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="undo-button hidden" id="undoButton">↩️ 取り消し (Z)</button>
                    <button class="pause-button" id="pauseButton">⏸ 一時停止</button>
                    <button class="reset-button" id="restartButton" style="display:none;">🔄 リスタート</button>
                    <button class="reset-button" id="resetButton">🏠 ホーム</button>
                </div>
                
                <!-- AI対戦用: モバイルAIゲージ -->
                <div class="ai-gauge-panel hidden" id="aiGaugePanel">
                    <div class="ai-gauge-header">🤖 AI</div>
                    <div class="ai-gauge-container">
                        <div class="ai-gauge-bar" id="aiGaugeBar"></div>
                    </div>
                    <div class="ai-gauge-lines">L:<span id="aiGaugeLines">0</span></div>
                </div>
            </div>
            
            <!-- AI対戦用: AI盤面パネル -->
            <div class="ai-game-panel hidden" id="aiGamePanel">
                <div class="ai-panel-header">🤖 AI</div>
                <canvas id="aiCanvas"></canvas>
                <canvas id="aiNextCanvas" width="80" height="80"></canvas>
                <div class="ai-panel-stats">
                    <div>Score: <span id="aiScoreDisplay">0</span></div>
                    <div>Lv: <span id="aiLevelDisplay">1</span></div>
                    <div>Lines: <span id="aiLinesDisplay">0</span></div>
                </div>
            </div>
        </div>

        <!-- ボタン操作パネル -->
        <div id="buttonControls" class="button-controls hidden">
            <div class="dpad-container">
                <!-- 十字キー -->
                <div class="dpad">
                    <div class="dpad-row">
                        <div class="dpad-empty"></div>
                        <button class="dpad-btn" id="upBtn">🔄<br><span style="font-size:10px;">回転</span></button>
                        <div class="dpad-empty"></div>
                    </div>
                    <div class="dpad-row">
                        <button class="dpad-btn" id="leftBtn">◀</button>
                        <button class="dpad-center-btn" id="centerBtn">⬇️</button>
                        <button class="dpad-btn" id="rightBtn">▶</button>
                    </div>
                    <div class="dpad-row">
                        <div class="dpad-empty"></div>
                        <button class="dpad-btn" id="downBtn2">⬇️<br><span style="font-size:10px;">落下</span></button>
                        <div class="dpad-empty"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="gameOverOverlay" class="overlay hidden">
        <div class="overlay-content game-over-overlay">
            <div class="overlay-title game-over-title">GAME OVER</div>
            <div class="overlay-score">最終スコア: <span id="finalScore">0</span></div>
            <button class="overlay-button" id="homeButton">🏠 ホームに戻る</button>
        </div>
    </div>

    <div id="pauseOverlay" class="overlay hidden">
        <div class="overlay-content pause-overlay">
            <div class="overlay-title pause-title">一時停止</div>
            <div class="overlay-score">タップまたはクリックで再開</div>
            <button class="overlay-button" onclick="game.togglePause()">▶ 再開</button>
        </div>
    </div>

    <div id="battleResultOverlay" class="overlay hidden">
        <div class="overlay-content">
            <div class="overlay-title" id="battleResultTitle">RESULT</div>
            <button class="overlay-button" onclick="restartBattle()">🔄 もう一度</button>
            <button class="overlay-button" onclick="goHomeFromBattle()">🏠 ホーム</button>
        </div>
    </div>

    <div id="battlePauseOverlay" class="overlay hidden">
        <div class="overlay-content">
            <div class="overlay-title">一時停止</div>
            <button class="overlay-button" onclick="battleManager && battleManager.togglePause()">▶ 再開</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
